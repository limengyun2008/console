<div class="main" id="appstats">
  <% if apperror %>
      <div class="container org-container">
        <div class="container-header">
          <h2>没有检测到APPLICATION，请检查您是否配置正确，或稍后再试</h2>
        </div>
      </div>
  <% elsif appguid.nil? %>
      <div class="container org-container">
        <div class="container-header">
          <h2><span>全部App状态信息列表</span></h2>
        </div>

        <table>
          <thead>
          <tr>
            <th width="15%">Guid</th>
            <th width="10%">App Name</th>
            <th width="20%">Url</th>
            <th width="10%">Package State</th>
            <th width="10%">Runtime State</th>
            <th width="10%">Instace Number</th>
            <th width="15%">Detail</th>
          </tr>
          </thead>
          <tbody>
          <% for guid, droplet in appstats %>
              <% if !droplet["deleting"] %>
                  <tr>
                    <td><%= guid %></td>
                    <td><%= droplet["appname"] %></td>
                    <td><a href="http://<%= droplet["route"] %>"><%= droplet["route"] %></a></td>
                    <td><%= droplet["package_state"] %></td>
                    <td><%= droplet["state"] %></td>
                    <td><%= droplet["num_instances"] %></td>
                    <td><span><a href="/appstats/<%= guid %>">Detail</a></span></td>
                  </tr>
              <% end %>
          <% end %>
          </tbody>
        </table>
      </div>
  <% else %>
      <div class="container org-container">
        <div class="container-header">
          <h2>APP: <%= app.name %> (<%= appguid %>) 状态信息</h2>
        </div>
        <h3>URL : <%= droplet["route"] %></h3>

        <% if droplet["alive"] %>
            <h3>Console : <a href="/app/<%= app.guid %>" class="button green"><%= app.name %>控制台</a></h3>
        <% else %>
            <h3>Console : APP当前不可访问，没有可用的控制台</h3>
        <% end %>

        <h3>
          Memory : <%= app.memory %> MB
        </h3>

        <h3>
          Disk Quota : <%= app.disk_quota %> MB
        </h3>

        <h3>
          Buildpack : <%= app.detected_buildpack %>
        </h3>

        <h3>
          Package State : <%= droplet["package_state"] %>
        </h3>

        <h3>
          Running State : <%= droplet["state"] %>
        </h3>

        <h3>
          Instance Numbser : <%= droplet["num_instances"] %>
        </h3>

        <h3>
          Crash Number : <%= droplet["crashes"].size %>
        </h3>

        <h3>
          Extra Instances Number : <%= droplet["extra_instances"].size %>
        </h3>

        <h3>
          All Instances:
        </h3>

        <script>
            var GLOBAL = {
                app_guid: '<%=app.guid %>'
            }
        </script>
        <div class="contents">
          <div class="tab-content active" id="control">

            <div id="instances-area">
              <img src="/image/loader.gif"/><span>querying</span>
            </div>
            <hr/>

            <% if app.state == "STARTED" %>
                <button class="big red" id="stop-app-admin">Stop This App</button>
                <button class="big blue" id="restart-app-admin">Restart This App</button>
            <% elsif app.state == "STOPPED" %>
                <button class="big green" id="start-app-admin">Start This App</button>
            <% end %>
            <button class="big red" id="delete-app-admin">Delete This App</button>
            <hr/>
          </div>
        </div>
        <br/>

        <p>
          <a href="/appstats" class="button green"> 返回查看全部App列表 </a>
        </p>

      </div>
  <% end %>
</div>